{% extends "base2.html" %}
{%- block title -%}{{ product.name }} - Premium Construction Product | Stumarcot Tanzania{%- endblock -%}

{%- block description -%}
    {%- if product.description -%}
        {{- product.description|truncate(150) -}}
    {%- else -%}
        Premium {{ product.name }} from Stumarcot Tanzania. High-quality construction materials with superior durability. Call +255 769 226111 for pricing and delivery.
    {%- endif -%}
{%- endblock -%}

{%- block keywords -%}
    {{ product.name }}, {%- if product.category -%}{{ product.category.name }}{%- else -%}construction materials{%- endif -%}, building supplies Tanzania, Stumarcot products, construction materials Dar es Salaam, 
    {%- if product.name.lower().find('block') != -1 -%}paving blocks, {%- endif -%}
    {%- if product.name.lower().find('tile') != -1 -%}floor tiles, wall tiles, {%- endif -%}
    quality construction products
{%- endblock -%}
{% block content %}
    <!-- Product Detail Section -->
    <section class="product-detail mt-4">
        <div class="container">
            <nav aria-label="breadcrumb" class="mb-4">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{{ url_for('views.home') }}">Home</a></li>
                    <li class="breadcrumb-item"><a href="{{ url_for('views.products') }}">Products</a></li>
                    <li class="breadcrumb-item active">{{ product.name }}</li>
                </ol>
            </nav>

            <div class="row">
                <!-- Product Images -->
                <div class="col-lg-6">
                    <div class="product-images">
                        <div class="main-image">
                            <div class="image-placeholder" id="mainProductImage">
                                {% if product.images %}
                                    <img src="{{ url_for('static', filename='uploads/' + product.images[0].image) }}" 
                                         alt="{{ product.name }}" class="img-fluid">
                                {% else %}
                                    <i class="fas fa-image fa-3x text-muted"></i>
                                    <p class="mt-2">No image available</p>
                                {% endif %}
                            </div>
                        </div>
                        {% if product.images|length > 1 %}
                        <div class="thumbnail-images mt-3">
                            {% for image in product.images[:4] %}
                            <div class="thumbnail {% if loop.first %}active{% endif %}" 
                                 onclick="changeMainImage('{{ url_for('static', filename='uploads/' + image.image) }}', this)">
                                <img src="{{ url_for('static', filename='uploads/' + image.image) }}" 
                                     alt="{{ product.name }}" class="img-fluid">
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Product Info -->
                <div class="col-lg-6">
                    <div class="product-detail-info">
                        <h1 id="productTitle">{{ product.name }}</h1>
                        <div class="product-rating mb-3">
                            <div class="stars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                           <!-- <span class="rating-text">(0 reviews)</span>-->
                        </div>

                        <div class="product-price mb-4">
                            <p class=""><i class="fas fa-phone"></i> CALL 0769 226111</p>
                            <!-- <span class="current-price" id="productPrice">${{ "%.2f"|format(product.price) }}</span>
                            {% if product.price > 50 %}
                            <span class="original-price">${{ "%.2f"|format(product.price * 1.2) }}</span>
                            <span class="discount-badge">17% OFF</span>
                            {% endif %} -->
                        </div>

                        <div class="product-description mb-4">
                            <p id="productDescription">
                                {% if product.description %}
                                    {{ product.description }}
                                {% else %}
                                    High-quality product perfect for your needs. Contact us for more details about specifications and availability.
                                {% endif %}
                            </p>
                        </div>

                       <!-- Product Features -->
                        <div class="product-features mb-4">
                            <h5>Key Features:</h5>
                            <ul id="productFeatures">
                                <li><i class="fas fa-check text-success me-2"></i>Superior durability and weather resistance</li>
                                <li><i class="fas fa-check text-success me-2"></i>High-strength, professional-grade materials</li>
                                <li><i class="fas fa-check text-success me-2"></i>User-friendly installation and low maintenance</li>
                                <li><i class="fas fa-check text-success me-2"></i>Compliance with industry safety standards</li>
                                <li><i class="fas fa-check text-success me-2"></i>Eco-friendly and sustainable options</li>
                                <li><i class="fas fa-check text-success me-2"></i>Comprehensive manufacturer warranty</li>
                                <li><i class="fas fa-check text-success me-2"></i>Versatile applications for various projects</li>
                                <li><i class="fas fa-check text-success me-2"></i>Cost-effective performance over time</li>
                            </ul>
                        </div>

                        <!-- Product Options -->
                         <!--
                        <div class="product-options mb-4">
                            <div class="option-group mb-3">
                                <label class="form-label">Quantity:</label>
                                <div class="quantity-selector">
                                    <button type="button" class="btn-quantity" onclick="changeQuantity(-1)">-</button>
                                    <input type="number" id="quantity" value="1" min="1" max="100">
                                    <button type="button" class="btn-quantity" onclick="changeQuantity(1)">+</button>
                                </div>
                            </div>
                        </div>
                        -->

                        <!-- Action Buttons -->
                        <div class="product-actions">
                            <!--
                            <button class="btn-add-cart-large" onclick="addToCartFromDetail('{{ product.id }}', '{{ product.name }}', {{ product.price }})">
                                <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                            </button>
                            -->
                            
                            <button class="btn-buy-now">
                                <i class="fab fa-whatsapp me-2"></i>Contact via WhatsApp
                            </button>
                            <button class="btn-wishlist">
                                <i class="fab fa-phone"></i>
                            </button>
                            
                        </div>

                        <!-- Additional Info -->
                        <div class="additional-info mt-4">
                            <div class="info-item">
                                <i class="fas fa-truck text-success me-2"></i>
                                <span>delivery available</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-undo text-primary me-2"></i>
                                <span>Premium Standard</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-shield-alt text-warning me-2"></i>
                                <span>Quality Product</span>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-calendar text-info me-2"></i>
                                <span>Listed on {{ product.created_at.strftime('%B %d, %Y') }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Product Tabs -->
    <section class="product-tabs">
        <div class="container">
            <ul class="nav nav-tabs" id="productTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="description-tab" data-bs-toggle="tab" data-bs-target="#description" type="button" role="tab">
                        Description
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="specifications-tab" data-bs-toggle="tab" data-bs-target="#specifications" type="button" role="tab">
                        Specifications
                    </button>
                </li>
           <!--    <li class="nav-item" role="presentation">
                    <button class="nav-link" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">
                        Reviews (0)
                    </button>
                </li>--> 
            </ul>
            <div class="tab-content" id="productTabsContent">
                <div class="tab-pane fade show active" id="description" role="tabpanel">
                    <div class="tab-content-inner">
                        <h4>Product Description</h4>
                        <p>{{ product.description or "Detailed product description coming soon. Contact us for more information about this product's features and specifications." }}</p>
                        
                        <h5>Product Details:</h5>
                        <ul>
                            <li><strong>Product ID:</strong> #{{ product.id }}</li>
                            <li><strong>Category:</strong> {{ product.category.name if product.category else 'General' }}</li>
                            <li><strong>Listed by:</strong> {{ product.user.username if product.user else 'Store Admin' }}</li>
                            <li><strong>Date Listed:</strong> {{ product.created_at.strftime('%B %d, %Y') }}</li>
                        </ul>
                    </div>
                </div>
                <div class="tab-pane fade" id="specifications" role="tabpanel">
                    <div class="tab-content-inner">
                        <h4>Technical Specifications</h4>
                        <table class="table table-striped">
                            <tbody>
                                <tr>
                                    <td><strong>Product Name</strong></td>
                                    <td>{{ product.name }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Product ID</strong></td>
                                    <td>#{{ product.id }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Price</strong></td>
                                    <td>${{ "%.2f"|format(product.price) }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Category</strong></td>
                                    <td>{{ product.category.name if product.category else 'General' }}</td>
                                </tr>
                                <tr>
                                    <td><strong>Availability</strong></td>
                                    <td>In Stock</td>
                                </tr>
                                <tr>
                                    <td><strong>Date Listed</strong></td>
                                    <td>{{ product.created_at.strftime('%B %d, %Y') }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-pane fade" id="reviews" role="tabpanel">
                    <div class="tab-content-inner">
                        <div class="reviews-summary">
                            <div class="text-center py-5">
                                <i class="fas fa-star fa-3x text-muted mb-3"></i>
                                <h5>No Reviews Yet</h5>
                                <p class="text-muted">Be the first to review this product!</p>
                                <button class="btn btn-primary">Write a Review</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Related Products -->
    {% if related_products %}
    <section class="related-products">
        <div class="container">
            <h3 class="section-title">Related Products</h3>
            <div class="row">
                {% for related_product in related_products %}
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="product-card-shop">
                        <div class="product-image-shop">
                            <a href="{{ url_for('views.product_single', product_id=related_product.id) }}">
                                {% if related_product.images %}
                                    <img src="{{ url_for('static', filename='uploads/' + related_product.images[0].image) }}" 
                                         alt="{{ related_product.name }}" class="img-fluid">
                                {% else %}
                                    <i class="fas fa-image fa-2x text-muted"></i>
                                {% endif %}
                            </a>
                        </div>
                        <div class="product-info">
                            <h5><a href="{{ url_for('views.product_single', product_id=related_product.id) }}">{{ related_product.name }}</a></h5>
                            <!--
                            <div class="product-price">
                                <span class="current-price">${{ "%.2f"|format(related_product.price) }}</span>
                            </div>
                        -->
                            <!--
                            <button class="btn-add-cart" onclick="addToCart('{{ related_product.id }}', '{{ related_product.name }}', {{ related_product.price }})">
                                <i class="fas fa-shopping-cart me-2"></i>Add to Cart
                            </button>
                            -->
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>
    {% endif %}

    <script>
                
        document.querySelector('.btn-buy-now').addEventListener('click', function() {
            window.location.href = "https://wa.me/255769226111?text=Hi!%20I%27m%20interested%20in%20your%20{{product.name}}.%20Could%20you%20share%20more%20details%20about%20it%3F";
        });

        // Function to change main product image
        function changeMainImage(imageSrc, thumbnail) {
            document.querySelector('#mainProductImage img').src = imageSrc;
            
            // Update active thumbnail
            document.querySelectorAll('.thumbnail').forEach(thumb => thumb.classList.remove('active'));
            thumbnail.classList.add('active');
        }

        // Function to change quantity
        function changeQuantity(change) {
            const quantityInput = document.getElementById('quantity');
            let currentValue = parseInt(quantityInput.value);
            let newValue = currentValue + change;
            
            if (newValue >= 1 && newValue <= 100) {
                quantityInput.value = newValue;
            }
        }

        // Function to add to cart from detail page
        function addToCartFromDetail(productId, productName, price) {
            const quantity = document.getElementById('quantity').value;
            // Add your cart functionality here
            console.log('Adding to cart:', {
                id: productId,
                name: productName,
                price: price,
                quantity: quantity
            });
            
            // Example: You can make an AJAX call to add to cart
            // fetch('/add-to-cart', {
            //     method: 'POST',
            //     headers: {
            //         'Content-Type': 'application/json',
            //     },
            //     body: JSON.stringify({
            //         product_id: productId,
            //         quantity: quantity
            //     })
            // });
            
            alert('Product added to cart!');
        }

        // Function to add to cart (for related products)
        function addToCart(productId, productName, price) {
            // Add your cart functionality here
            console.log('Adding to cart:', {
                id: productId,
                name: productName,
                price: price,
                quantity: 1
            });
            
            alert('Product added to cart!');
        }
    </script>
{% endblock %}